{% extends "incidencias/base_incidencias.html" %}
{% load static i18n %}

{% block incidencias_content %}
<!-- Hero / Search Section -->
<div class="rounded-2xl p-8 mb-8 bg-gradient-to-br from-primary to-secondary text-primary-content shadow-lg">
  <div class="max-w-2xl mx-auto text-center">
    <h1 class="text-3xl font-bold mb-2 text-white drop-shadow-md">ğŸ”§ Incidencias</h1>
    <p class="text-white/90 mb-6 drop-shadow-sm font-medium">Reporta problemas tÃ©cnicos o busca incidencias existentes</p>

    <div class="form-control">
      <div class="relative">
        <input type="text"
               id="search-input"
               name="q"
               placeholder="Buscar incidencia por tÃ­tulo o descripciÃ³n..."
               class="input input-lg w-full text-base-content pr-12"
               autocomplete="off"
               hx-get="{% url 'incidencias:buscar' %}"
               hx-trigger="keyup changed delay:300ms"
               hx-target="#incidencias-list"
               hx-indicator="#search-spinner">
        <div id="search-spinner" class="htmx-indicator absolute right-4 top-1/2 -translate-y-1/2">
          <span class="loading loading-spinner loading-sm"></span>
        </div>
      </div>
    </div>

    <div class="mt-4">
      <a href="{% url 'incidencias:crear' %}" class="btn btn-lg btn-accent gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
        </svg>
        Crear nueva incidencia
      </a>
    </div>
  </div>
</div>

<!-- Stats -->
<div class="stats stats-horizontal shadow w-full mb-6">
  <div class="stat">
    <div class="stat-figure text-warning">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
    </div>
    <div class="stat-title">Pendientes</div>
    <div class="stat-value text-warning">{{ total_pendientes }}</div>
  </div>
  <div class="stat">
    <div class="stat-figure text-info">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
      </svg>
    </div>
    <div class="stat-title">En progreso</div>
    <div class="stat-value text-info">{{ total_en_progreso }}</div>
  </div>
  <div class="stat">
    <div class="stat-figure text-success">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
    </div>
    <div class="stat-title">Resueltas</div>
    <div class="stat-value text-success">{{ total_resueltas }}</div>
  </div>
</div>

<!-- Incident List -->
<div id="incidencias-list">
  {% include "incidencias/partials/lista_incidencias.html" %}
</div>
{% endblock incidencias_content %}
