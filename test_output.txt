 Container martina_bescos_app_local_redis  Running
 Container martina_bescos_app_local_mailpit  Running
 Container martina_bescos_app_local_postgres  Running
wait-for-it: waiting 30 seconds for postgres:5432
wait-for-it: postgres:5432 is available after 0 seconds
PostgreSQL is available
Source CSS file 1 not found, skipping removal: /app/martina_bescos_app/static/css/index.css
Source CSS file 2 not found, skipping removal: /app/martina_bescos_app/static/css/input.css
Running collectstatic...

0 static files copied to '/app/staticfiles', 236 unmodified.
Found 1 test(s).
Creating test database for alias 'default'...
‚úÖ Asignatura 'M√∫sica' creada y asignada a 0 grupos
System check identified no issues (0 silenced).
INFO 2026-02-12 20:16:24,472 pages 1 281473239597088 Page created: "Music Library" id=3 content_type=cms.MusicLibraryIndexPage path=/home/music-library/
INFO 2026-02-12 20:16:24,477 pages 1 281473239597088 Page edited: "Music Library" id=3 revision_id=1
INFO 2026-02-12 20:16:24,485 publish_revision 1 281473239597088 Published: "Music Library" pk=3 revision_id=1
INFO 2026-02-12 20:16:24,489 pages 1 281473239597088 Page created: "Jazz Tune" id=4 content_type=cms.ScorePage path=/home/music-library/jazz-tune/
INFO 2026-02-12 20:16:24,494 pages 1 281473239597088 Page edited: "Jazz Tune" id=4 revision_id=2
INFO 2026-02-12 20:16:24,503 publish_revision 1 281473239597088 Published: "Jazz Tune" pk=4 revision_id=2
INFO 2026-02-12 20:16:24,507 pages 1 281473239597088 Page created: "Rhythmic Dictation" id=5 content_type=cms.DictadoPage path=/home/music-library/rhythmic-dictation/
INFO 2026-02-12 20:16:24,511 pages 1 281473239597088 Page edited: "Rhythmic Dictation" id=5 revision_id=3
INFO 2026-02-12 20:16:24,520 publish_revision 1 281473239597088 Published: "Rhythmic Dictation" pk=5 revision_id=3
F
======================================================================
FAIL: test_regression_fixes (cms.tests.test_frontend_integration.FrontendIntegrationTest.test_regression_fixes)
Verifica correcciones de regresi√≥n:
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/cms/tests/test_frontend_integration.py", line 74, in test_regression_fixes
    self.assertIn('M15.536 8.464a5 5 0 010 7.072', content)
AssertionError: 'M15.536 8.464a5 5 0 010 7.072' not found in '\n<!DOCTYPE html>\n\n<html lang="en" data-theme="light">\n  <head>\n    <meta charset="utf-8" />\n    <meta http-equiv="x-ua-compatible" content="ie=edge" />\n    <title>\n      Music Library - Music Pills\n  </title>\n  <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n  <meta name="description"\n        content="Behold My Awesome Project!" />\n  <meta name="author"\n        content="Jes√∫s L√≥pez de Leyva" />\n  <meta name="referrer" content="origin" />\n  <meta name="csrf-token" content="R43n6kbEzeGKBRz6vUYH93A0opqrXDqjxG8tJuevIXQ8nT4MpAD1jyBc6tXPaSaj">\n  <!-- Favicon: ICO primero para Chrome, SVG para navegadores modernos -->\n  <link rel="icon" href="/static/images/favicons/favicon.ico" sizes="32x32" />\n  <link rel="icon" href="/static/images/favicons/favicon.svg" type="image/svg+xml" />\n  <link rel="apple-touch-icon" href="/static/images/favicons/favicon.svg" />\n  \n    <!-- Tailwind CSS con DaisyUI -->\n    <link href="/static/css/output.css" rel="stylesheet" />\n    <!-- This file stores project-specific CSS -->\n    <link href="/static/css/project.css" rel="stylesheet" />\n  \n  \n  \n<style>\n    /* Fila clickeable completa */\n    .score-item .list-row {\n        text-decoration: none;\n        color: inherit;\n        display: flex;\n        width: 100%;\n    }\n    \n    .score-item .list-row:hover {\n        background-color: rgba(0, 0, 0, 0.05);\n    }\n    \n    .score-item {\n        position: relative;\n        display: flex;\n        align-items: center;\n        gap: 1rem;\n    }\n</style>\n\n  <!-- Le javascript\n      ================================================== -->\n  \n  \n    <!-- HTMX -->\n    <script src="https://unpkg.com/htmx.org@1.9.6" integrity="sha384-FhXw7b6AlE/jyjlZH5iHa/tTe9EpJ1Y55RjcgPbjeWMskSxZt1v9qkxLJWNJaGni" crossorigin="anonymous"></script>\n    <!-- Alpine.js -->\n    <script defer src="https://unpkg.com/alpinejs@3.12.1/dist/cdn.min.js"></script>\n    <!-- CSRF token configuration for HTMX -->\n    <script>\n      document.addEventListener(\'DOMContentLoaded\', function() {\n        // Configurar token CSRF para HTMX\n        document.documentElement.addEventListener(\'htmx:configRequest\', function(event) {\n          event.detail.headers[\'X-CSRFToken\'] = \'R43n6kbEzeGKBRz6vUYH93A0opqrXDqjxG8tJuevIXQ8nT4MpAD1jyBc6tXPaSaj\';\n        });\n        \n        // Inicializar tema desde localStorage\n        const savedTheme = localStorage.getItem(\'theme\');\n        if (savedTheme) {\n          document.documentElement.setAttribute(\'data-theme\', savedTheme);\n        }\n      });\n    </script>\n    <!-- place project specific Javascript in this file -->\n    <script defer src="/static/js/project.js"></script>\n  \n</head>\n<body class="min-h-screen bg-base-100">\n  \n  \n  <div class="drawer">\n    <input id="my-drawer-3" type="checkbox" class="drawer-toggle" /> \n    <div class="drawer-content flex flex-col">\n      <!-- Navbar -->\n      <div class="navbar bg-base-100 shadow-lg sticky top-0 z-40">\n        <div class="flex-none">\n          <label for="my-drawer-3" class="btn btn-square btn-ghost drawer-button lg:hidden">\n            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-6 h-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>\n          </label>\n        </div>\n        <div class="flex-1">\n          <a class="btn btn-ghost text-xl" href="/pages/indice-de-recursos-musicales/">Martina Besc√≥s Music App</a>\n        </div>\n        <div class="flex-none hidden lg:block">\n          <ul class="menu menu-horizontal">\n            \n            \n            \n            \n              \n                <li><a id="sign-up-link" href="/accounts/signup/">Sign Up</a></li>\n              \n              <li><a id="log-in-link" href="/accounts/login/">Sign In</a></li>\n            \n          </ul>\n        </div>\n        <div class="flex-none">\n          \n          <a href="/ayuda/" class="btn btn-ghost btn-circle" aria-label="Ayuda">\n            <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.02 2.575-2.5 2.9-.73.16-1.5.77-1.5 1.6v.5m0 3h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />\n            </svg>\n          </a>\n          <button id="theme-toggle" class="btn btn-ghost btn-circle">\n            <label class="swap swap-rotate">\n              <input type="checkbox" />\n              <!-- sol icono - mostrar cuando data-theme es dark -->\n              <svg class="swap-on h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />\n              </svg>\n              <!-- luna icono - mostrar cuando data-theme es light -->\n              <svg class="swap-off h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />\n              </svg>\n            </label>\n          </button>\n        </div>\n      </div>\n      <!-- Page content here -->\n      <div class="container mx-auto px-4 py-8">\n        \n        \n          \n<div class="container mx-auto px-4 py-8">\n    \n\n    \n\n    <!-- Filters and Search -->\n    <div class="mb-6">\n        <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-6">\n            \n            <!-- Search and Filters -->\n            <div class="flex flex-col sm:flex-row gap-3 w-full lg:w-auto">\n                <!-- Search Input -->\n                <form method="GET" action="." class="form-control join w-full max-w-sm" id="searchForm" role="search">\n                    \n                    <input type="hidden" name="tags" value="Jazz">\n                    \n                    \n                    \n                    <div class="join w-full">\n                        <input type="text" \n                               name="q" \n                               value=""\n                               placeholder="Search scores..." \n                               class="input input-bordered join-item w-full sm:w-64" \n                               aria-label="Search"\n                               hx-get="."\n                               hx-trigger="keyup changed delay:500ms, search"\n                               hx-target="#musicResults"\n                               hx-select="#musicResults"\n                               hx-include="#searchForm"\n                               hx-on::after-swap="updatePagination()">\n                        <button type="submit" class="btn btn-square join-item">\n                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>\n                        </button>\n                    </div>\n                </form>\n                \n                <!-- Tag Filter -->\n                <div class="dropdown dropdown-end">\n                    <div tabindex="0" role="button" class="btn btn-outline">\n                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>\n                        </svg>\n                        \n                            Jazz\n                        \n                    </div>\n                    <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52 max-h-64 overflow-y-auto">\n                        <li>\n                            <a href="?" class="text-sm">\n                                Clear Filter\n                            </a>\n                        </li>\n                        <li class="menu-title"><span>Available Tags</span></li>\n                        \n                            <li>\n                                <a href="?tags=Classical" \n                                   class="text-sm ">\n                                    üè∑Ô∏è Classical\n                                </a>\n                            </li>\n                        \n                            <li>\n                                <a href="?tags=Jazz" \n                                   class="text-sm active">\n                                    üè∑Ô∏è Jazz\n                                </a>\n                            </li>\n                        \n                    </ul>\n                </div>\n            </div>\n        </div>\n\n\n        \n\n        <!-- Music Content List (Scores + Dictados) -->\n        <div id="musicResults">\n            <ul class="list bg-base-100 rounded-box shadow-md" id="musicList">\n                \n                <li class="p-4 pb-2 text-xs opacity-60 tracking-wide">Your Music Library</li>\n                \n                \n                \n                \n                <li class="music-item flex items-center gap-2" \n                    data-index="0">\n                    \n                        <!-- Cursor pointer for row -->\n                        <div class="list-row flex items-center gap-4 p-4 hover:bg-base-200 transition-colors flex-1 min-w-0 cursor-pointer"\n                             onclick="window.location.href=\'/pages/music-library/jazz-tune/\'"\n                             role="link"\n                             tabindex="0">\n                        \n                        <!-- Icon Column -->\n                        <div class="w-10 h-10 rounded-lg flex items-center justify-center shrink-0\n                            bg-primary/10 text-primary\n                            ">\n                            \n                            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path>\n                            </svg>\n                            \n                        </div>\n\n                        <!-- Content Info -->\n                        <div class="flex-1 min-w-0">\n                            <div class="font-medium truncate">Jazz Tune</div>\n                            <div class="text-xs opacity-60 truncate">\n                                \n                                    UNKNOWN\n                                \n                            </div>\n\n                            <!-- PDF and Audio Info -->\n                            \n                            \n                            \n                            <!-- File Titles (Restored) -->\n                            \n                            \n\n                            <!-- Categories -->\n                            <div class="flex flex-wrap gap-1 mt-1">\n                                \n                            </div>\n\n                            <!-- Tags -->\n                            <div class="flex flex-wrap gap-1 mt-1">\n                                \n                                <a href="?tags=Jazz" \n                                   class="badge badge-xs badge-outline text-[10px] px-1 h-5 hover:opacity-80"\n                                   style="color: #123456; border-color: #123456;"\n                                   onclick="event.stopPropagation()">\n                                    Jazz\n                                </a>\n                                \n                            </div>\n                        </div>\n                    </div>\n\n                    <!-- Actions -->\n                    <div class="flex items-center gap-1 pr-2">\n                        \n                        \n                        <div class="dropdown dropdown-end">\n                            <label tabindex="0" class="btn btn-ghost btn-square btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" />\n                                </svg>\n                            </label>\n                            <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52">\n                                <li><a href="/pages/music-library/jazz-tune/">View Details</a></li>\n                                \n                            </ul>\n                        </div>\n                    </div>\n                </li>\n                \n                \n            </ul>\n            \n            <!-- Load More Button (Client-side pagination for results) -->\n            <div id="loadMoreContainer" class="text-center mt-6 hidden">\n                <button onclick="loadMoreMusic()" class="btn btn-outline btn-primary">\n                    Cargar m√°s contenido\n                    <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>\n                    </svg>\n                </button>\n                <p class="text-xs text-base-content/50 mt-2">\n                    Mostrando <span id="visibleCount">5</span> de <span id="totalCount">1</span>\n                </p>\n            </div>\n\n            \n        </div>\n        \n    </div>\n\n\n    <!-- Editorial Section: Blog Posts + Tests -->\n    \n\n\n    \n\n<script>\n// MUSIC PILLS - Paginaci√≥n de biblioteca musical\n// La funcionalidad de filtrado ahora se maneja en backend\n\nconst ITEMS_PER_PAGE = 5;\nlet currentlyVisible = ITEMS_PER_PAGE;\n\nfunction loadMoreMusic() {\n    currentlyVisible += ITEMS_PER_PAGE;\n    updatePagination();\n}\n\nfunction updatePagination() {\n    const musicItems = document.querySelectorAll(\'.music-item\');\n    const totalItems = musicItems.length;\n    \n    // Show items within the currentlyVisible limit\n    musicItems.forEach((item, index) => {\n        if (index < currentlyVisible) {\n            // Show item (use flex to match the class)\n            item.style.display = \'flex\';\n        } else {\n            // Hide item beyond pagination limit\n            item.style.display = \'none\';\n        }\n    });\n    \n    // Update counter\n    const actuallyVisible = Math.min(currentlyVisible, totalItems);\n    const visibleCountEl = document.getElementById(\'visibleCount\');\n    if (visibleCountEl) visibleCountEl.textContent = actuallyVisible;\n    \n    // Show/hide load more button\n    const loadMoreContainer = document.getElementById(\'loadMoreContainer\');\n    if (loadMoreContainer) {\n        // Show button if there are more items than currently visible\n        if (totalItems > currentlyVisible) {\n            loadMoreContainer.classList.remove(\'hidden\');\n        } else {\n            loadMoreContainer.classList.add(\'hidden\');\n        }\n    }\n}\n\ndocument.addEventListener(\'DOMContentLoaded\', function() {\n    // Initialize pagination\n    updatePagination();\n});\n</script>\n\n        \n      </div>\n      <footer class="mt-8 border-t border-base-300">\n        <div class="container mx-auto px-4 py-6 text-center text-sm text-base-content/70">\n          <a href="https://github.com/deleyva/app-martina" class="link link-hover" target="_blank" rel="noopener noreferrer">\n            Made with ‚ù§Ô∏è in the open\n          </a>\n        </div>\n      </footer>\n    </div> \n    <div class="drawer-side">\n      <label for="my-drawer-3" class="drawer-overlay"></label> \n      <ul class="menu p-4 w-80 h-full bg-base-100">\n        <li><a href="/">Home</a></li>\n        <li><a href="/about/">About</a></li>\n        \n          \n            <li><a id="sign-up-link-mobile" href="/accounts/signup/">Sign Up</a></li>\n          \n          <li><a id="log-in-link-mobile" href="/accounts/login/">Sign In</a></li>\n        \n        \n      </ul>\n    </div>\n  </div>\n  \n  \n  \n  \n  <!-- Toast Container para notificaciones -->\n  <div class="toast toast-end toast-top z-50" id="toastContainer"></div>\n  \n  \n    \n    \n    <script>\n      // Sistema de notificaciones Toast\n      function showToast(message, type = \'info\') {\n        const toastContainer = document.getElementById(\'toastContainer\');\n        \n        // Crear el elemento toast\n        const toast = document.createElement(\'div\');\n        toast.className = `alert alert-${type} shadow-lg`;\n        toast.innerHTML = `\n          <div>\n            <span>${message}</span>\n          </div>\n        `;\n        \n        // A√±adir al contenedor\n        toastContainer.appendChild(toast);\n        \n        // Auto-eliminar despu√©s de 3 segundos\n        setTimeout(() => {\n          toast.style.opacity = \'0\';\n          toast.style.transition = \'opacity 0.3s\';\n          setTimeout(() => {\n            toast.remove();\n          }, 300);\n        }, 3000);\n      }\n    </script>\n  \n  \n  \n  <!-- Extra JavaScript for specific pages -->\n  \n</body>\n</html>\n'

----------------------------------------------------------------------
Ran 1 test in 0.152s

FAILED (failures=1)
Destroying test database for alias 'default'...

