{% load wagtailimages_tags %}

<div class="w-full h-full flex flex-col">
    <!-- Selector de imagen si hay múltiples -->
    {% if images|length > 1 %}
    <div class="py-2 px-2 flex justify-center gap-2 flex-wrap print:hidden">
        {% for image in images %}
        <button onclick="showImage({{ forloop.counter0 }})" 
                class="btn btn-sm {% if forloop.first %}btn-primary{% else %}btn-ghost{% endif %}"
                id="img-btn-{{ forloop.counter0 }}">
            Imagen {{ forloop.counter }}
        </button>
        {% endfor %}
    </div>
    {% endif %}
    
    <!-- Contenedor de imágenes - sin padding, full width -->
    <div class="flex-1 flex items-center justify-center bg-white overflow-auto">
        {% for image in images %}
        <div id="image-{{ forloop.counter0 }}" 
             class="image-container w-full {% if not forloop.first %}hidden{% endif %}">
            {% if image.title %}
            <h3 class="text-lg font-bold px-4 py-2 bg-gray-100">{{ image.title }}</h3>
            {% endif %}
            
            {% if image.image %}
                {# Block from ScorePage with .image field #}
                {% image image.image original as img %}
                <img src="{{ img.url }}" 
                     alt="{{ image.title|default:'Imagen' }}" 
                     class="w-full h-auto block">
            {% elif image.file %}
                {# Wagtail Image object directly - has .file attribute #}
                <img src="{{ image.file.url }}" 
                     alt="{{ image.title|default:'Imagen' }}" 
                     class="w-full h-auto block">
            {% else %}
                {# Try direct rendering if it's an Image model #}
                {% image image original as img %}
                <img src="{{ img.url }}" 
                     alt="{{ image.title|default:'Imagen' }}" 
                     class="w-full h-auto block">
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>

{% if images|length > 1 %}
<script>
function showImage(index) {
    // Ocultar todas las imágenes
    document.querySelectorAll('.image-container').forEach(function(el) {
        el.classList.add('hidden');
    });
    
    // Mostrar imagen seleccionada
    document.getElementById('image-' + index).classList.remove('hidden');
    
    // Actualizar botones
    document.querySelectorAll('[id^="img-btn-"]').forEach(function(btn) {
        btn.classList.remove('btn-primary');
        btn.classList.add('btn-ghost');
    });
    document.getElementById('img-btn-' + index).classList.remove('btn-ghost');
    document.getElementById('img-btn-' + index).classList.add('btn-primary');
}
</script>
{% endif %}
