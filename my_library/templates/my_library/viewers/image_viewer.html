{% load wagtailimages_tags %}

<div class="w-full flex flex-col" style="min-height: 100vh;">
    <!-- Selector de imagen si hay múltiples -->
    {% if images|length > 1 %}
    <div class="py-4 px-2 flex justify-center gap-2 flex-wrap print:hidden" style="background: #000;">
        {% for image in images %}
        <button onclick="showImage({{ forloop.counter0 }})" 
                style="padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer; border: none; {% if forloop.first %}background: #3b82f6; color: white;{% else %}background: rgba(255,255,255,0.1); color: white;{% endif %}"
                id="img-btn-{{ forloop.counter0 }}">
            Imagen {{ forloop.counter }}
        </button>
        {% endfor %}
    </div>
    {% endif %}
    
    <!-- Contenedor de imágenes - sin restricciones de altura -->
    <div class="w-full bg-white">
        {% for image in images %}
        <div id="image-{{ forloop.counter0 }}" 
             class="image-container w-full {% if not forloop.first %}hidden{% endif %}">
            {% if image.title %}
            <div class="px-4 py-3 bg-gray-100 text-lg font-bold">{{ image.title }}</div>
            {% endif %}
            
            {% if image.image %}
                {# Block from ScorePage with .image field #}
                {% image image.image original as img %}
                <img src="{{ img.url }}" 
                     alt="{{ image.title|default:'Imagen' }}" 
                     style="width: 100%; height: auto; display: block;">
            {% elif image.file %}
                {# Wagtail Image object directly - has .file attribute #}
                <img src="{{ image.file.url }}" 
                     alt="{{ image.title|default:'Imagen' }}" 
                     style="width: 100%; height: auto; display: block;">
            {% else %}
                {# Try direct rendering if it's an Image model #}
                {% image image original as img %}
                <img src="{{ img.url }}" 
                     alt="{{ image.title|default:'Imagen' }}" 
                     style="width: 100%; height: auto; display: block;">
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>

{% if images|length > 1 %}
<script>
function showImage(index) {
    // Ocultar todas las imágenes
    document.querySelectorAll('.image-container').forEach(function(el) {
        el.classList.add('hidden');
    });
    
    // Mostrar imagen seleccionada
    document.getElementById('image-' + index).classList.remove('hidden');
    
    // Actualizar botones
    document.querySelectorAll('[id^="img-btn-"]').forEach(function(btn) {
        btn.style.background = 'rgba(255,255,255,0.1)';
        btn.style.color = 'white';
    });
    var activeBtn = document.getElementById('img-btn-' + index);
    activeBtn.style.background = '#3b82f6';
    activeBtn.style.color = 'white';
}
</script>
{% endif %}
